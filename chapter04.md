## 4.1 ALU와 제어장치

### ALU

레지스터를 통해 **피연산자**를 받아들이고, 제어장치로 부터 수행할 연산을 알려주는 **제어 신호**를 받아들임
연산을 수행한 결과는 바로 메모리에 저장되지 않고 일시적으로 레지스터에 저장 → CPU가 접근하는 속도 때문에
계산 결과와 더불어 **플래그**를 내보냄 → 연산 결과에 대한 추가적인 정보
EX ) 부호 플래그, 제로 플래그, 캐리 플래그, 오버플로우 플래그, 인터럽트 플래그, 슈퍼바이저 플래그
플래그들은 플래그 레지스터에 저장

### 제어장치

제어 신호를 내보내고, 명령어를 해석하는 부품, 제어 신호는 컴퓨터 부품을 관리하고 작동시키기 위한 일종의 전기 신호

1. 제어장치는 클럭 신호를 받아들인다
    1. 클럭이란 모든 부품을 일사불란하게 움직일 수 있게 하는 시간 단위
2. 제어장치는 ‘해석해야 할 명령어’를 받아들인다
    1. 제어장치는 명령어 레지스터로 부터 해석할 명령어를 받아들이고 해석한 뒤, 제어 신호를 발생
3. 제어장치는 플래그 레지스터 속 플래그 값을 받아들인다
    1. 플래그 값을 참고하여 제어 신호 발생
4. 제어장치는 시스템 버스, 그중에서 제어 버스로 전달된 제어 신호를 받아들인다
    1. 제어장치는 제어 버스를 통해 외부로부터 전달된 제어 신호를 받아들일 수 있다

## 4.2 레지스터

- 프로그램 카운터
    - 메모리에서 가져올 명령어의 주소, 즉 메모리에서 읽어 들일 명령어의 주소를 저장. 명령어 포인터라고 부르는 CPU도 있음
- 명령어 레지스터
    - 방금 메모리에서 읽어 들인 명령어를 저장하는 레지스터
- 메모리 주소 레지스터
    - 메모리의 주소를 저장하는 레지스터. CPU가 읽어 들이고자 하는 주소 값을 주소 버스로 보낼 때 메모리 주소 레지스터를 거치게 된다
- 메모리 버퍼 레지스터
    - 메모리와 주고받을 값(데이터와 명령어)을 저장하는 레지스터. 메모리에 쓰고 싶은 값이나 메모리로부터 전달받은 값은 메모리 버퍼 레지스터를 거침
- 범용 레지스터
    - 범용 레지스터는 데이터와 주소를 모두 저장할 수 있음
- 플래그 레지스터
    - 연산 결과 또는 CPU 상태에 대한 부가적인 정보를 저장

### 스택 주소 지정 방식

스택 포인터는 스택 주소 지정 방식이라는 주소 지정 방식에 사용되고, 프로그램 카운터와 베이스 레지스터는 변위 주소 지정 방식이라는 주소 지정 방식에 사용

- 스택 주소 지정 방식
    - 스택과 스택 포인터를 이용한 주소 지정 방식 ⇒ 스택 포인터가 스택의 꼭대기를 가리키는 레지스터

### 변위 주소 지정 방식

오퍼랜드 필드 값(변위)과 특정 레지스터의 값을 더하여 유효 주소를 얻어내는 주소 지정 방식. 오퍼랜드 필드의 주소와 어떤 레지스터를 더하는지에 따라 상대 주소 지정 방식, 베이스 레지스터 주소 지정 방식 드응로 나뉜다.

- 상대 주소 지정 방식
    - 오퍼랜드와 프로그램 카운터의 값을 더하여 유효 주소를 얻는 방식
- 베이스 레지스터 주소 지정 방식
    - 오퍼랜드와 베이스 레지스터의 값을 더하여 유효주소를 얻는 방식

## 4.3 명령어 사이클과 인터럽트

하나의 명령어를 처리하는 정형화된 흐름을 **명령어 사이클**이라고 함

간혹 이 흐름이 끊어지는 상황을 **인터럽트**라고 함

### 명령어 사이클

1. 메모리에 있는 명령어를 CPU로 가지고 오는 단계를 인출 사이클 이라고 함
2. CPU로 가져온 명령어를 실행하는 단계를 실행 사이클 이라고 함
3. 간접 주소 지정 방식은 오퍼랜드 필드에 유효 주소의 주소를 명시 → 명령어를 인출하여 CPU로 가져왔다 하더라도 바로 실행 사이클에 돌입할 수 없음 → 명령어를 실행하기 위해서는 메모리 접근을 한 번 더 해야하기 때문. 이 단계를 간접 사이클 이라고 함

### 인터럽트

CPU의 작업을 방해하는 신호를 인터럽트 라고 함

- 동기 인터럽트
    - CPU에 의해 발생하는 인터럽트. CPU가 명령어들을 수행하다가 예상치 못한 상황에 마주쳤을때 발생
    - 예외(exception) 라고 부름
- 비동기 인터럽트
    - 주로 입출력장치에 의해 발생하는 인터럽트. 세탁기 완료 알림, 전자레인지 조리 완료 알림과 같은 알림 역할
- 하드웨어 인터럽트
    - 하드웨어 인터럽트를 이용하면 CPU는 해당 인터럽트를 받을 때까지 다른 작업을 처리할 수 있음
        1. 입출력 장치는 CPU에 인터럽트 요청 신호를 보냄
        2. CPU는 실행 사이클이 끝나고 명령어를 인출하기 전 항상 인터럽트 여부를 확인
        3. CPU는 인터럽트 요청을 확인하고 인터럽트 플래그를 통해 현재 인터럽트를 받아들일 수 있는지 여부 확인
        4. 인터럽트를 받아들일 수 있다면 CPU는 지금까지의 작업을 백업
        5. CPU는 인터럽트 벡터를 참조하여 인터럽트 서비스 루틴을 실행
        6. 인터럽트 서비스 루틴 실행이 끝나면 백업해 둔 작업을 복구하여 실행 재개
            1. CPU의 정상적인 실행 흐름을 끊는 것이기 때문에 인터러트하기 전에 **인터럽트 요청 신호**를 보냄
            2. CPU가 인터럽트 요청을 수용하기 위해서는 플래그 레지스터의 **인터럽트 플래그**가 활성화 되어 있어야함
            3. 인터럽트 요청을 받아들이기로 했다면 인터럽트를 처리하기 위해 **인터럽트 서비스 루틴** 실행 (인터럽트 핸들러)
            4. CPU는 수많은 인터럽트 서비스 루틴을 구분하기 위해 **인터럽트 벡터**를 이용