## 13.1 교착 상태란

일어나지 않을 사건을 기다리며 진행이 멈춰 버리는 현상

교착 상태를 해결하기 위해서는

1. 교착 상태가 발생했을 때의 상황을 정확하게 표현
2. 교착 상태가 일어나는 근본적인 이유에 대하여 알기

### 자원 할당 그래프

어떤 프로세스가 어떤 자원을 사용하고 있고, 또 어떤 프로세스가 어떤 자원을 기다리고 있는지를 표현하는 간단한 그래프

1. 프로세스는 원으로, 자원의 종류는 사각형으로 표현
2. 사용할 수 있는 자원의 개수는 자원 사각형 내에 점으로 표현
3. 프로세스가 어떤 자원을 핟아받아 사용 중이라면 자원에서 프로세스를 향해 화살표를 표시
4. 프로세스가 어떤 자원을 기다리고 있다면 프로세스에서 자원으로 화살표를 표시

교착 상태가 발생한 상황은 자원 할당 그래프가 원의 형태를 띄고 있음

### 교착 상태 발생 조건

- 상호 배제 : 교착 상태가 발생한 근본적인 원인은 해당 자원을 한 번에 하나의 프로세스만 이용 가능했기 때문 ⇒ 상호 배제 상황에서 교착 상태 발생
- 점유와 대기 : 어떠한 자원을 할당받은 상태에서 다른 자원을 할당받기를 기다린다면 교착 상태가 발생할 수 있음. 자원을 할당받은 상태에서 다른 자원을 할당받기를 기다리는 상태를 점유와 대기 라고 함
- 비선점 : 비선점 자원은 그 자원을 이용하는 프로세스의 작업이 끝나야만 비로소 이용할 수 있다. 어떤 프로세스도 다른 프로세스의 자원을 강제로 빼앗지 못했기 때문에 교착 상태가 발생했다고 볼 수 있음
- 원형 대기 : 프로세스들이 원의 형태로 자원을 대기하는 것을 원형 대기라고함

## 13.2 교착 상태 해결 방법

### 교착 상태 예방

교착 상태 발생 필요 조건 네 가지 중 하나를 충족하지 못하게 하는 방법

- 상호 배제
- 점유와 대기
- 비선점
- 원형 대기

중 하나의 조건이라도 만족시키지 않게 할당하면 교착 상태는 발생하지 않음

- 상호 배제 없애기 : 모든 자원의 공유⇒ 현실적으로 불가능
- 점유와 대기 없애기 : 특정 프로세스에 자원을 모두 할당하거나, 아예 할당하지 않는 방식으로 배분 ⇒ 자원의 활용률이 낮아질 우려가 있음. 점유와 대기를 금지하면 많은 자원을 사용하는 프로세스가 불리해짐 ⇒ 많은 자원을 필요로 하는 프로세스가 무한정 기다리게 되는 기아 현상을 야기할 우려가 있음
- 비선점 조건 없애기 : 자원을 이용 중인 프로세스로부터 해당 자원을 빼앗을 수 있음. 이 방식은 선점하여 사용할 수 있는 일부 자원에 대해서는 효과적. 한 번에 하나의 프로세스만 이용 가능한 프린터 자원이 있다고 생각한다면 다른 프로세스가 프린터 자원을 빼앗아 사용하기 어려움 ⇒ 비선점 조건을 없애 모든 자원을 빼앗을 수 있도록 하여 교착 상태를 예방하는 방법은 다소 범용성이 떨어지는 방안
- 원형 대기 조건 없애기 : 모든 자원에 번호를 붙이고 오름차순으로 자원을 할당하면 원형 대기는 발생하지 않음. 모든 자원에 번호를 붙이는 일이 간단하지 않고, 특정 자원의 활용률이 떨어질 수 있음.

### 교착 상태 회피

프로세스들에 할당할 수 있는 자원이 충분한 상황에서 프로세스들이 한두 개의 적은 자원만을 요구한다면 교착 상태는 발생하지 않음. 반면 프로세스들이 할당할 수 있는 자원이 한정된 상황에서 모든 프로세스들이 한 번에 많은 자원을 요구하면 교착 상태가 발생할 위험이 증가

- 안전 상태 : 교착 상태가 발생하지 않고 모든 프로세스가 정상적으로 자원을 할당받고 종료될 수 있는 상태
- 불안전 상태  : 교착 상태가 발생할 수도 있는 상황
- 안전 순서열 : 교착 상태 없이 안전하게 프로세스들에 자원을 할당할 수 있는 순서, 불안전 상태는 안전 순서열이 없는 상황

### 교착 상태 검출 후 회복

예방 / 회피는 교착상태 발생을 막기 위한 노력, 검출 후 회복은 교착 상태 발생을 인정하고 사후에 조치하는 방식

- 선점을 통한 회복 : 교착 상태가 해결될 때까지 한 프로세스씩 자원을 몰아주는 방식
- 프로세스 강제 종료를 통한 회복 : 모든 프로세스를 강제 종료하거나 교착 상태가 없어질 때까지 한 프로세스씩 강제 종료