## 8.2 다양한 입출력 방법

### 프로그램 입출력

기본적으로 프로그램 속 명령어로 입출력을 제어하는 방법

1. CPU는 하드 디스크 컨트롤러의 제어 레지스터에 쓰기 명령을 보냄
2. 하드 디스크 컨트롤러는 하드 디스크 상태를 확인, 하드 디스크가 준비된 상태라면 하드 디스크 컨트롤러는 상태 레지스터에 준비되었다고 표시
3. CPU는 상태 레지스터를 주기적으로 읽어보며 하드 디스크의 준비 여부를 확인, 하드 디스크가 준비됐음을 CPU가 알게 되면 백업할 메모리의 정보를 데이터 레지스터에 씀. 백업 작업이 끝나지 않았다면 처음부터 반복, 쓰기가 끝났다면 작업 종료

- 메모리 맵 입출력 : 메모리에 접근하기 위한 주소 공간과 입출력장치에 접근하기 위한 주소 공간을 하나의 주소 공간으로 간주하는 방법
- 고립형 입출력 : 메모리를 위한 주소 공간과 입출력장치를 위한 주소 공간을 분리하는 방법

### 인터럽트 기반 입출력

CPU는 장치 컨트롤러에 입출력 작업을 명령하고, 장치 컨트롤러가 입출력장치를 제어하며 입출력을 수행하는 동안 CPU는 다른 일을할 수 있음

장치 컨트롤러가 입출력 작업을 끝낸 뒤 CPU에게 인터럽트 요청 신호를 보내면 CPU는 하던 일을 백업하고 인터럽트 서비스 루틴 실행

- 프로그래머블 인터럽트 컨트롤러(PIC) : 여러 장치 컨트롤러에 연결되어 장치 컨트롤러에서 보낸 하드웨어 인터럽트 요청들의 우선순위를 판별한 뒤 CPU에 지금 처리해야 할 하드웨어 인트럽트는 무엇인지 알려주는 장치
    1. PIC가 장치 컨트롤러에서 **인터럽트 요청 신호**를 받아들임
    2. PIC는 인터럽트 우선순위를 판단한 뒤 CPU에 처리해야 할 **인터럽트 요청 신호**를 보냄
    3. CPU는 PIC에 **인터럽트 확인 신호**를 보냄
    4. PIC는 데이터 버스를 통해 CPU에 **인터럽트 벡터**를 보냄
    5. CPU는 인터럽트 벡터를 통해 인터럽트 요청의 주체를 알게 되고, 해당 장치의 **인터럽트 서비스 루틴**을 실행

### DMA 입출력

입출력장치와 메모리가 CPU를 거치지 않고도 상호작용할 수 있는 입출력방식 (Direct Memory Access)

DMA 이불력을 하기 위해서는 시스템 버스에 연결된 **DMA 컨트롤러**라는 하드웨어가 필요

1. CPU는 DMA 컨트롤러에 입출력장치의 주소, 수행할 연산, 읽거나 쓸 메모리의 주소 등과 같은 정보로 입출력 작업을 명령
2. DMA 컨트롤러는 CPU 대신 장치 컨트롤러와 상호작용하며 입출력 작업을 수행, 이때 DMA 컨트롤러는 필요한 경우 메모리에 직접 접근하여 정보를 읽거나 씀
3. 입출력 작업이 끝나면 DMA 컨트롤러는 CPU에 인터럽트를 걸어 작업이 끝났음을 알림

DMA를 위해 시스템 버스를 너무 자주 사용하면 그만큼 CPU가 시스템 버스를 이용하지 못함. 이 문제는 DMA 컨트롤러와 장치 컨트롤러들을 **입출력 버스**라는 별도의 버스에 연결하여 해결

입출력 버스에는 PCI(Peripheral Component Interconnec)버스, PCI Express(PCIe) 등 여러 종류가 있음.